# 股票爬蟲工具 - 產品需求文件 (PRD)

## 1. 產品概述

### 1.1 產品名稱
股票爬蟲工具 (Stock Crawler GUI)

### 1.2 產品描述
一個基於 Python tkinter 的桌面應用程式，提供友善的圖形介面來爬取台灣股票市場的即時資料。使用者可以選擇特定股票，一鍵爬取股票的即時價格、漲跌幅、成交量等重要資訊。

### 1.3 目標用戶
- 股票投資者
- 金融分析師
- 程式開發者
- 對股票資料有需求的研究人員

### 1.4 產品價值
- 簡化股票資料獲取流程
- 提供即時股票資訊
- 支援批量股票資料爬取
- 友善的圖形化操作介面

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 股票清單管理
- **功能描述**: 顯示所有可爬取的台灣股票清單
- **詳細需求**:
  - 自動載入所有股票代碼以 "2" 開頭且為 4 位數的股票
  - 顯示股票代碼、名稱、市場類別
  - 支援股票搜尋功能（按代碼或名稱）
  - 提供全選/取消全選功能

#### 2.1.2 股票選擇
- **功能描述**: 允許用戶選擇要爬取的股票
- **詳細需求**:
  - 支援多選股票
  - 視覺化顯示已選擇的股票
  - 限制選擇數量提示（超過10支股票時會有確認提示）

#### 2.1.3 資料爬取
- **功能描述**: 爬取選定股票的即時資料
- **詳細需求**:
  - 使用 crawl4ai 框架爬取 wantgoo 網站
  - 支援非同步批量爬取
  - 顯示爬取進度
  - 錯誤處理機制

#### 2.1.4 結果顯示
- **功能描述**: 以結構化方式顯示爬取結果
- **詳細需求**:
  - 顯示每支股票的詳細資訊
  - 包含爬取時間戳記
  - 支援結果捲動瀏覽
  - 清晰的資料格式化

### 2.2 輔助功能

#### 2.2.1 搜尋功能
- 即時搜尋過濾股票清單
- 支援按股票代碼或名稱搜尋

#### 2.2.2 狀態顯示
- 顯示應用程式當前狀態
- 載入進度指示器
- 爬取進度顯示

#### 2.2.3 錯誤處理
- 網路連線錯誤提示
- 爬取失敗錯誤處理
- 友善的錯誤訊息顯示

## 3. 技術需求

### 3.1 技術架構
- **前端**: Python tkinter
- **爬蟲引擎**: crawl4ai
- **股票資料源**: twstock、wantgoo.com
- **非同步處理**: asyncio
- **多線程**: threading

### 3.2 系統需求
- Python 3.8+
- 相關依賴套件：
  - tkinter (內建)
  - crawl4ai
  - twstock
  - asyncio (內建)
  - threading (內建)

### 3.3 資料結構
```python
# 股票資料結構
{
    "日期時間": "2025-01-XX XX:XX:XX",
    "股票號碼": "2330",
    "股票名稱": "台積電",
    "即時價格": "XXX.XX",
    "漲跌": "+X.XX",
    "漲跌百分比": "+X.XX%",
    "開盤價": "XXX.XX",
    "最高價": "XXX.XX",
    "最低價": "XXX.XX",
    "成交量(張)": "XXXXX",
    "前一日收盤價": "XXX.XX"
}
```

## 4. 用戶介面需求

### 4.1 主視窗布局
- **視窗大小**: 1200x800 像素
- **布局方式**: 左右分割布局
- **標題**: "股票爬蟲工具"

### 4.2 左側面板 - 股票選擇區
- **股票清單**: TreeView 元件顯示
- **搜尋框**: 即時過濾功能
- **選擇按鈕**: 全選、取消全選
- **欄位**: 代碼、名稱、市場

### 4.3 右側面板 - 控制與結果區
- **控制面板**: 
  - 開始爬取按鈕
  - 進度顯示
  - 狀態訊息
- **結果顯示區**: 
  - 捲動文字區域
  - 結構化資料顯示

### 4.4 底部狀態列
- 顯示當前操作狀態
- 載入股票數量資訊

## 5. 性能需求

### 5.1 響應時間
- 股票清單載入: < 3 秒
- 單支股票爬取: < 5 秒
- 批量爬取 (10支): < 30 秒

### 5.2 併發處理
- 支援最多 5 個併發爬取任務
- 速率限制: 0.5-1.0 秒間隔

### 5.3 錯誤恢復
- 自動重試機制
- 網路超時處理
- 優雅的錯誤降級

## 6. 安全需求

### 6.1 爬取行為
- 遵守 robots.txt
- 適當的請求間隔
- 避免對目標網站造成負擔

### 6.2 資料處理
- 本地資料處理，不上傳敏感資訊
- 適當的異常處理

## 7. 可用性需求

### 7.1 易用性
- 直觀的操作介面
- 清晰的功能標示
- 適當的操作回饋

### 7.2 可維護性
- 模組化程式碼結構
- 清晰的錯誤訊息
- 完整的註解文件

## 8. 測試需求

### 8.1 功能測試
- 股票清單載入測試
- 搜尋功能測試
- 爬取功能測試
- 錯誤處理測試

### 8.2 性能測試
- 大量股票選擇測試
- 併發爬取測試
- 長時間運行測試

### 8.3 用戶介面測試
- 視窗大小調整測試
- 操作流程測試
- 跨平台相容性測試

## 9. 部署需求

### 9.1 安裝需求
- Python 環境設定
- 依賴套件安裝
- 設定檔配置

### 9.2 執行方式
```bash
# 安裝依賴
pip install -r requirements.txt

# 執行應用程式
python lesson6/stock_gui.py
```

## 10. 未來擴展

### 10.1 短期擴展
- 匯出爬取結果到 CSV/Excel
- 新增更多股票資料來源
- 排程自動爬取功能

### 10.2 長期擴展
- 資料視覺化圖表
- 歷史資料追蹤
- 股票分析工具整合
- 網頁版本開發

## 11. 風險評估

### 11.1 技術風險
- 目標網站結構變更
- 爬取限制政策變更
- 依賴套件更新問題

### 11.2 緩解措施
- 靈活的爬取策略設計
- 多重資料來源備援
- 定期更新維護

---

**文件版本**: 1.0  
**最後更新**: 2025年7月29日  
**負責人**: AI Assistant  
**審核狀態**: 待審核
